<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>XO Offline Pro</title>

<style>
:root{
  --neon:#00ffcc;
  --bg:#000;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:var(--bg);
  color:var(--neon);
  font-family:monospace;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}
.app{max-width:360px;width:100%;text-align:center}
h1{margin:6px 0;text-shadow:0 0 10px var(--neon)}
input,select,button{
  width:100%;
  margin:4px 0;
  padding:6px;
  font-weight:bold;
}
button{cursor:pointer}
#msg{
  height:70px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
  text-shadow:0 0 12px var(--neon);
}
.board{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:6px;
  margin:10px 0;
}
.cell{
  aspect-ratio:1;
  border:2px solid var(--neon);
  font-size:3rem;
  display:flex;
  justify-content:center;
  align-items:center;
  cursor:pointer;
}
.cell.win{
  animation:blink .6s infinite;
}
@keyframes blink{
  0%{background:#000}
  50%{background:#00ffcc;color:#000}
  100%{background:#000}
}
</style>
</head>

<body>
<div class="app">

<h1>XO OFFLINE</h1>

<input id="p1" placeholder="Player 1 name" value="Player 1">
<input id="p2" placeholder="Player 2 / AI name" value="AI">

<select id="mode">
  <option value="">Select Mode</option>
  <option value="pvp">2 Players</option>
  <option value="ai">VS AI</option>
</select>

<select id="aiLevel">
  <option value="easy">AI Easy</option>
  <option value="hard">AI Hard</option>
  <option value="extreme">AI Extreme</option>
</select>

<button onclick="start()">START</button>
<button onclick="reset()">RESET</button>

<div id="msg">READY</div>
<div class="board" id="board"></div>

</div>

<script>
/* ================= CORE ================= */
const boardEl=document.getElementById("board");
const msgEl=document.getElementById("msg");
const sfx={
  click:new Audio("data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAIA+AAACABAAZGF0YRAAAA=="),
  win:new Audio("data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAIA+AAACABAAZGF0YRAAAA=="),
  draw:new Audio("data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAIA+AAACABAAZGF0YRAAAA==")
};

let board,turn,gameOver,mode,aiLevel,names;

function start(){
  names={
    X:p1.value||"Player 1",
    O:modeSel.value==="ai"?(p2.value||"AI"):(p2.value||"Player 2")
  };
  mode=modeSel.value;
  aiLevel=aiSel.value;
  reset();
}
const modeSel=document.getElementById("mode");
const aiSel=document.getElementById("aiLevel");

function reset(){
  board=Array(9).fill("");
  turn="X";
  gameOver=false;
  boardEl.innerHTML="";
  for(let i=0;i<9;i++){
    const d=document.createElement("div");
    d.className="cell";
    d.onclick=()=>play(i);
    boardEl.appendChild(d);
  }
  msg(`${names?.X||"Player 1"} TURN`);
}

function msg(t){msgEl.textContent=t}

/* ================= GAME ================= */
function play(i){
  if(gameOver||!mode||board[i]) return warn();
  board[i]=turn;
  sfx.click.play();
  render();

  const winLine=checkWin(board,turn);
  if(winLine){
    winLine.forEach(i=>boardEl.children[i].classList.add("win"));
    sfx.win.play();
    msg(`ðŸ† ${names[turn]} WIN`);
    gameOver=true;
    return;
  }

  if(board.every(v=>v)){
    sfx.draw.play();
    msg("ðŸ¤ DRAW");
    gameOver=true;
    return;
  }

  turn=turn==="X"?"O":"X";
  msg(`${names[turn]} TURN`);

  if(mode==="ai"&&turn==="O"){
    setTimeout(aiMove,400);
  }
}

function warn(){msg("âš  INVALID MOVE")}

function render(){
  [...boardEl.children].forEach((c,i)=>c.textContent=board[i]);
}

/* ================= AI ================= */
function aiMove(){
  let move;
  if(aiLevel==="easy"){
    move=randomMove();
  }else if(aiLevel==="hard"){
    move=minimax(board,0,true,3).index;
  }else{
    move=minimax(board,0,true).index;
  }
  play(move);
}

function randomMove(){
  const e=board.map((v,i)=>v?null:i).filter(v=>v!==null);
  return e[Math.floor(Math.random()*e.length)];
}

function minimax(newBoard,depth,isMax,limit=Infinity){
  const score=evalBoard(newBoard);
  if(score!==null||depth>=limit) return {score};

  let best={score:isMax?-Infinity:Infinity};
  newBoard.forEach((v,i)=>{
    if(!v){
      newBoard[i]=isMax?"O":"X";
      const r=minimax(newBoard,depth+1,!isMax,limit);
      newBoard[i]="";
      r.index=i;
      if(isMax? r.score>best.score : r.score<best.score)
        best=r;
    }
  });
  return best;
}

function evalBoard(b){
  if(checkWin(b,"O")) return 10;
  if(checkWin(b,"X")) return -10;
  if(b.every(v=>v)) return 0;
  return null;
}

/* ================= WIN CHECK ================= */
function checkWin(b,p){
  const w=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
  for(const a of w)
    if(a.every(i=>b[i]===p)) return a;
  return null;
}
</script>
</body>
</html>
